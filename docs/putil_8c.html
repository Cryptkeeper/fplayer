<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fplayer: src/putil.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">fplayer
   </div>
   <div id="projectbrief">C99 Falcon Sequence (fseq) file player for Light-O-Rama hardware (like xLights)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('putil_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">putil.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Player utility functions implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="putil_8h_source.html">putil.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;tinyfseq.h&quot;</code><br />
<code>#include &quot;tinylor.h&quot;</code><br />
<code>#include &quot;<a class="el" href="audio_8h_source.html">audio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cell_8h_source.html">cell.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="seq_8h_source.html">fseq/seq.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="serial_8h_source.html">serial.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="errcode_8h_source.html">std2/errcode.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="time_8h_source.html">time.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for putil.c:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c__incl.png" border="0" usemap="#asrc_2putil_8c" alt=""/></div>
<map name="asrc_2putil_8c" id="asrc_2putil_8c">
<area shape="rect" title="Player utility functions implementation." alt="" coords="499,5,578,31"/>
<area shape="rect" href="putil_8h.html" title="Playback utility functions." alt="" coords="841,79,897,105"/>
<area shape="poly" title=" " alt="" coords="579,24,687,45,826,76,825,81,686,50,578,29"/>
<area shape="rect" title=" " alt="" coords="98,79,166,105"/>
<area shape="poly" title=" " alt="" coords="499,28,362,48,182,81,181,76,362,43,498,22"/>
<area shape="rect" title=" " alt="" coords="190,79,250,105"/>
<area shape="poly" title=" " alt="" coords="499,30,266,81,264,76,498,25"/>
<area shape="rect" title=" " alt="" coords="274,79,337,105"/>
<area shape="poly" title=" " alt="" coords="500,34,353,79,351,74,498,29"/>
<area shape="rect" title=" " alt="" coords="361,79,439,105"/>
<area shape="poly" title=" " alt="" coords="516,34,438,74,436,69,514,29"/>
<area shape="rect" title=" " alt="" coords="463,79,529,105"/>
<area shape="poly" title=" " alt="" coords="534,33,513,67,509,64,529,30"/>
<area shape="rect" href="audio_8h.html" title="Audio system interface." alt="" coords="11,79,74,105"/>
<area shape="poly" title=" " alt="" coords="499,26,325,44,210,60,90,81,89,76,209,55,324,39,499,20"/>
<area shape="rect" href="cell_8h.html" title="Cell table for tracking output states." alt="" coords="658,79,710,105"/>
<area shape="poly" title=" " alt="" coords="564,29,647,69,644,74,562,34"/>
<area shape="rect" href="seq_8h.html" title="FSEQ sequence file loading API." alt="" coords="735,79,817,105"/>
<area shape="poly" title=" " alt="" coords="579,29,721,71,720,77,577,34"/>
<area shape="rect" href="serial_8h.html" title="Serial port communication interface." alt="" coords="1050,79,1113,105"/>
<area shape="poly" title=" " alt="" coords="578,20,771,38,900,54,1035,76,1034,81,899,60,770,43,578,25"/>
<area shape="rect" href="errcode_8h.html" title="Error code definitions and message strings." alt="" coords="921,79,1025,105"/>
<area shape="poly" title=" " alt="" coords="578,23,906,76,905,81,578,28"/>
<area shape="rect" href="time_8h.html" title="Basic time tracking utility functions." alt="" coords="552,79,610,105"/>
<area shape="poly" title=" " alt="" coords="548,30,568,64,564,67,543,33"/>
<area shape="rect" title=" " alt="" coords="744,153,808,178"/>
<area shape="poly" title=" " alt="" coords="855,107,805,145,802,141,852,103"/>
<area shape="rect" title=" " alt="" coords="5,153,80,178"/>
<area shape="poly" title=" " alt="" coords="45,105,45,137,40,137,40,105"/>
<area shape="poly" title=" " alt="" coords="701,103,750,141,747,145,698,107"/>
<area shape="poly" title=" " alt="" coords="1050,104,1038,107,824,156,823,151,1037,102,1048,99"/>
<area shape="rect" title=" " alt="" coords="1060,153,1102,178"/>
<area shape="poly" title=" " alt="" coords="1084,105,1084,137,1078,137,1078,105"/>
<area shape="poly" title=" " alt="" coords="611,101,730,145,728,150,609,106"/>
<area shape="poly" title=" " alt="" coords="609,76,627,78,634,84,636,92,633,101,625,106,623,102,629,98,631,92,630,86,625,83,608,81"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab3d0be82de2dfcc8994230af517dbee9" id="r_ab3d0be82de2dfcc8994230af517dbee9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3d0be82de2dfcc8994230af517dbee9">PU_wait</a> (struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *sdev, const unsigned int seconds)</td></tr>
<tr class="memdesc:ab3d0be82de2dfcc8994230af517dbee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for the given number of seconds by blocking the current thread. LOR heartbeat messages will intentionally be sent during this time. This function is used to ensure the LOR hardware is connected to the player before sending playback commands.  <br /></td></tr>
<tr class="separator:ab3d0be82de2dfcc8994230af517dbee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc0ea5bccde45a6f82364c2b9a38a7d" id="r_aecc0ea5bccde45a6f82364c2b9a38a7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecc0ea5bccde45a6f82364c2b9a38a7d">PU_lightsOff</a> (struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *sdev)</td></tr>
<tr class="memdesc:aecc0ea5bccde45a6f82364c2b9a38a7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns off all lights by sending a set off effect to all LOR units.  <br /></td></tr>
<tr class="separator:aecc0ea5bccde45a6f82364c2b9a38a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac34b8e816274fbd4207f4d02dfe54fed" id="r_ac34b8e816274fbd4207f4d02dfe54fed"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac34b8e816274fbd4207f4d02dfe54fed">PU_secondsRemaining</a> (const uint32_t frame, const struct tf_header_t *seq)</td></tr>
<tr class="memdesc:ac34b8e816274fbd4207f4d02dfe54fed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the seconds remaining in the sequence based on the current frame and sequence configuration provided by the caller.  <br /></td></tr>
<tr class="separator:ac34b8e816274fbd4207f4d02dfe54fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad065eb627423f95e1ee6245f81c170d5" id="r_ad065eb627423f95e1ee6245f81c170d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad065eb627423f95e1ee6245f81c170d5">PU_writeHeartbeat</a> (struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *sdev)</td></tr>
<tr class="memdesc:ad065eb627423f95e1ee6245f81c170d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encodes and writes a LOR heartbeat message to the serial port.  <br /></td></tr>
<tr class="separator:ad065eb627423f95e1ee6245f81c170d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb13572c6a1cf5854bb058e36e20562" id="r_a4eb13572c6a1cf5854bb058e36e20562"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4eb13572c6a1cf5854bb058e36e20562">PU_writeEffect</a> (struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *sdev, const struct <a class="el" href="structctgroup__s.html">ctgroup_s</a> *group, uint32_t *accum)</td></tr>
<tr class="memdesc:a4eb13572c6a1cf5854bb058e36e20562"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encodes the given channel group state update to the provided message buffer as a LOR effect. The number of bytes written to the message buffer will be added to the optional accumulator parameter.  <br /></td></tr>
<tr class="separator:a4eb13572c6a1cf5854bb058e36e20562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab280e2231023e7e95533aa0134fc61d9" id="r_ab280e2231023e7e95533aa0134fc61d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab280e2231023e7e95533aa0134fc61d9">PU_playFirstAudio</a> (const char *<a class="el" href="main_8c.html#a6827cae48504568ff8afb5a127427ca7">audiofp</a>, struct <a class="el" href="struct_f_c.html">FC</a> *fc, const struct tf_header_t *seq)</td></tr>
<tr class="memdesc:ab280e2231023e7e95533aa0134fc61d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">If audiofp is not NULL, this function will attempt to play the audio file at the given path. If audiofp is NULL, this function will attempt to lookup the <code>mf</code> (media file) variable within the file controller and play the audio file at the path stored in the variable.  <br /></td></tr>
<tr class="separator:ab280e2231023e7e95533aa0134fc61d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Player utility functions implementation. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aecc0ea5bccde45a6f82364c2b9a38a7d" name="aecc0ea5bccde45a6f82364c2b9a38a7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc0ea5bccde45a6f82364c2b9a38a7d">&#9670;&#160;</a></span>PU_lightsOff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PU_lightsOff </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *</td>          <td class="paramname"><span class="paramname"><em>sdev</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns off all lights by sending a set off effect to all LOR units. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdev</td><td>serial device to write the command to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, a negative error code on failure </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_cgraph.png" border="0" usemap="#aputil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_cgraph" alt=""/></div>
<map name="aputil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_cgraph" id="aputil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_cgraph">
<area shape="rect" title="Turns off all lights by sending a set off effect to all LOR units." alt="" coords="5,31,102,56"/>
<area shape="rect" href="serial_8c.html#a420d471225d62a4cf280dfc3ef59d3f1" title="Waits for all data to be written to the serial device." alt="" coords="150,5,239,31"/>
<area shape="poly" title=" " alt="" coords="102,32,134,26,135,32,102,37"/>
<area shape="rect" href="serial_8c.html#a59d3d8b6bd5c63d8346079182204f30e" title="Writes the binary data to the open serial port. The data is copied to an internal buffer and written ..." alt="" coords="150,55,239,80"/>
<area shape="poly" title=" " alt="" coords="102,49,135,55,134,60,102,54"/>
<area shape="rect" href="serial_8c.html#a706542c2b6ac4b13b60019221d8972ee" title="Prints an error message to stderr for the given error code, including the libserialport error message..." alt="" coords="461,29,576,55"/>
<area shape="poly" title=" " alt="" coords="240,19,446,34,446,40,239,24"/>
<area shape="rect" href="serial_8c.html#a4ff646f526789549fa410a488a47abae" title="Writes the binary data to the &quot;real&quot; opened serial port handle within the virtual serial device struc..." alt="" coords="292,55,408,80"/>
<area shape="poly" title=" " alt="" coords="240,65,277,65,277,70,240,70"/>
<area shape="rect" href="serial_8c.html#a1375dc381934802544fa63f692f1d782" title="Writes the binary data to the virtual file handle within the virtual serial device structure." alt="" coords="287,104,413,130"/>
<area shape="poly" title=" " alt="" coords="238,78,294,96,292,101,237,84"/>
<area shape="poly" title=" " alt="" coords="409,56,446,50,446,56,409,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_icgraph.png" border="0" usemap="#aputil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_icgraph" alt=""/></div>
<map name="aputil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_icgraph" id="aputil_8c_aecc0ea5bccde45a6f82364c2b9a38a7d_icgraph">
<area shape="rect" title="Turns off all lights by sending a set off effect to all LOR units." alt="" coords="381,5,478,31"/>
<area shape="rect" href="player_8c.html#a30eb7f640562f5e082f537431fabfae0" title="Main loop of the player that drives the playback of the sequence. This function will block until the ..." alt="" coords="244,5,333,31"/>
<area shape="poly" title=" " alt="" coords="366,21,334,21,334,16,366,16"/>
<area shape="rect" href="player_8c.html#aaf3b0aad85ffca607bbf0daa9d634dc1" title="Initializes and starts playback of the given playback configuration. Execution will block until the s..." alt="" coords="103,5,196,31"/>
<area shape="poly" title=" " alt="" coords="228,21,196,21,196,16,228,16"/>
<area shape="rect" href="main_8c.html#ad5a52bc0401ed1bc06c779de5371d560" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ab280e2231023e7e95533aa0134fc61d9" name="ab280e2231023e7e95533aa0134fc61d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab280e2231023e7e95533aa0134fc61d9">&#9670;&#160;</a></span>PU_playFirstAudio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PU_playFirstAudio </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>audiofp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_f_c.html">FC</a> *</td>          <td class="paramname"><span class="paramname"><em>fc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct tf_header_t *</td>          <td class="paramname"><span class="paramname"><em>seq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If audiofp is not NULL, this function will attempt to play the audio file at the given path. If audiofp is NULL, this function will attempt to lookup the <code>mf</code> (media file) variable within the file controller and play the audio file at the path stored in the variable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">audiofp</td><td>suggested audio file path to play, or NULL to lookup from fc </td></tr>
    <tr><td class="paramname">fc</td><td>file controller to read a fallback audio file from </td></tr>
    <tr><td class="paramname">seq</td><td>sequence header for file layout information </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, a negative error code on failure </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ab280e2231023e7e95533aa0134fc61d9_cgraph.png" border="0" usemap="#aputil_8c_ab280e2231023e7e95533aa0134fc61d9_cgraph" alt=""/></div>
<map name="aputil_8c_ab280e2231023e7e95533aa0134fc61d9_cgraph" id="aputil_8c_ab280e2231023e7e95533aa0134fc61d9_cgraph">
<area shape="rect" title="If audiofp is not NULL, this function will attempt to play the audio file at the given path...." alt="" coords="5,207,136,232"/>
<area shape="rect" href="audio_8c.html#a0c9f7a75cf5e965c07b70cdde5f15cfa" title="Attempts to play the audio file at the given file path. This function initializes the audio system if..." alt="" coords="204,132,289,158"/>
<area shape="poly" title=" " alt="" coords="102,204,199,162,201,167,104,209"/>
<area shape="rect" href="seq_8c.html#aa46d33d98cef6abf5a1027e93ec87862" title="Retrieves the audio file path from the sequence for playback by searching the FSEQ&#39;s variable table f..." alt="" coords="184,256,309,282"/>
<area shape="poly" title=" " alt="" coords="120,230,184,249,183,254,118,236"/>
<area shape="rect" href="audio_8c.html#a31ee90daccbe20571bf17f4706a8103a" title="Checks the playback status of the audio system." alt="" coords="357,56,471,82"/>
<area shape="poly" title=" " alt="" coords="276,129,369,86,371,91,278,134"/>
<area shape="rect" href="audio_8c.html#a088c9ba211c55d9a74c2cdba5f880a61" title="Stops the current audio playback, if any. The last allocated AL buffer is then detached from the sour..." alt="" coords="519,5,653,31"/>
<area shape="poly" title=" " alt="" coords="255,130,295,85,324,60,356,41,392,28,430,19,504,12,504,18,431,24,394,33,358,46,327,65,299,89,259,133"/>
<area shape="rect" href="audio_8c.html#ab8d211abfcf3a5272bc45db36f041ea8" title="Prints the last OpenAL error to stderr with the given message." alt="" coords="701,56,772,82"/>
<area shape="poly" title=" " alt="" coords="289,136,685,74,686,79,290,141"/>
<area shape="rect" href="audio_8c.html#a42e1c8367745030b6c984745e79dc43e" title="Initializes the audio system if it has not been initialized yet." alt="" coords="379,157,449,183"/>
<area shape="poly" title=" " alt="" coords="290,149,364,160,363,165,289,154"/>
<area shape="rect" href="audio_8c.html#a684cbaee8df68440661b3b06ff1b8f51" title="Prints the last ALUT error to stderr with the given message." alt="" coords="373,207,455,232"/>
<area shape="poly" title=" " alt="" coords="277,156,358,193,369,198,367,203,356,198,275,161"/>
<area shape="poly" title=" " alt="" coords="460,53,525,33,527,38,461,58"/>
<area shape="poly" title=" " alt="" coords="472,66,685,66,685,72,472,72"/>
<area shape="poly" title=" " alt="" coords="627,29,687,49,685,55,626,34"/>
<area shape="rect" href="fc_8c.html#a567dd57b805c1d46e224bd218e9c4293" title="Reads the given number of bytes from the file controller starting at the given offset." alt="" coords="378,256,450,282"/>
<area shape="poly" title=" " alt="" coords="310,266,363,266,363,272,310,272"/>
<area shape="rect" href="seq_8c.html#a45be30e286fb245a61523a355f63ee95" title="Reads a variable from the variable table and populates the provided var struct with the variable id,..." alt="" coords="366,305,462,331"/>
<area shape="poly" title=" " alt="" coords="294,280,354,298,353,303,292,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ab280e2231023e7e95533aa0134fc61d9_icgraph.png" border="0" usemap="#aputil_8c_ab280e2231023e7e95533aa0134fc61d9_icgraph" alt=""/></div>
<map name="aputil_8c_ab280e2231023e7e95533aa0134fc61d9_icgraph" id="aputil_8c_ab280e2231023e7e95533aa0134fc61d9_icgraph">
<area shape="rect" title="If audiofp is not NULL, this function will attempt to play the audio file at the given path...." alt="" coords="244,5,374,31"/>
<area shape="rect" href="player_8c.html#aaf3b0aad85ffca607bbf0daa9d634dc1" title="Initializes and starts playback of the given playback configuration. Execution will block until the s..." alt="" coords="103,5,196,31"/>
<area shape="poly" title=" " alt="" coords="228,21,196,21,196,16,228,16"/>
<area shape="rect" href="main_8c.html#ad5a52bc0401ed1bc06c779de5371d560" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ac34b8e816274fbd4207f4d02dfe54fed" name="ac34b8e816274fbd4207f4d02dfe54fed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac34b8e816274fbd4207f4d02dfe54fed">&#9670;&#160;</a></span>PU_secondsRemaining()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long PU_secondsRemaining </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>frame</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct tf_header_t *</td>          <td class="paramname"><span class="paramname"><em>seq</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the seconds remaining in the sequence based on the current frame and sequence configuration provided by the caller. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame</td><td>current frame in the sequence </td></tr>
    <tr><td class="paramname">seq</td><td>sequence header for playback configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>seconds remaining in the sequence, or 0 if the sequence is complete </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ac34b8e816274fbd4207f4d02dfe54fed_icgraph.png" border="0" usemap="#aputil_8c_ac34b8e816274fbd4207f4d02dfe54fed_icgraph" alt=""/></div>
<map name="aputil_8c_ac34b8e816274fbd4207f4d02dfe54fed_icgraph" id="aputil_8c_ac34b8e816274fbd4207f4d02dfe54fed_icgraph">
<area shape="rect" title="Returns the seconds remaining in the sequence based on the current frame and sequence configuration p..." alt="" coords="512,5,670,31"/>
<area shape="rect" href="player_8c.html#a56fa00589840072b269070591b8c155d" title="Prints a log message summarizing the player&#39;s current state." alt="" coords="381,5,464,31"/>
<area shape="poly" title=" " alt="" coords="496,21,464,21,464,16,496,16"/>
<area shape="rect" href="player_8c.html#a30eb7f640562f5e082f537431fabfae0" title="Main loop of the player that drives the playback of the sequence. This function will block until the ..." alt="" coords="244,5,333,31"/>
<area shape="poly" title=" " alt="" coords="366,21,334,21,334,16,366,16"/>
<area shape="rect" href="player_8c.html#aaf3b0aad85ffca607bbf0daa9d634dc1" title="Initializes and starts playback of the given playback configuration. Execution will block until the s..." alt="" coords="103,5,196,31"/>
<area shape="poly" title=" " alt="" coords="228,21,196,21,196,16,228,16"/>
<area shape="rect" href="main_8c.html#ad5a52bc0401ed1bc06c779de5371d560" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ab3d0be82de2dfcc8994230af517dbee9" name="ab3d0be82de2dfcc8994230af517dbee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3d0be82de2dfcc8994230af517dbee9">&#9670;&#160;</a></span>PU_wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PU_wait </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *</td>          <td class="paramname"><span class="paramname"><em>sdev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>seconds</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for the given number of seconds by blocking the current thread. LOR heartbeat messages will intentionally be sent during this time. This function is used to ensure the LOR hardware is connected to the player before sending playback commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdev</td><td>serial device to write the heartbeat messages to </td></tr>
    <tr><td class="paramname">seconds</td><td>number of seconds to wait </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, a negative error code on failure </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ab3d0be82de2dfcc8994230af517dbee9_cgraph.png" border="0" usemap="#aputil_8c_ab3d0be82de2dfcc8994230af517dbee9_cgraph" alt=""/></div>
<map name="aputil_8c_ab3d0be82de2dfcc8994230af517dbee9_cgraph" id="aputil_8c_ab3d0be82de2dfcc8994230af517dbee9_cgraph">
<area shape="rect" title="Waits for the given number of seconds by blocking the current thread. LOR heartbeat messages will int..." alt="" coords="5,31,77,56"/>
<area shape="rect" href="serial_8c.html#a59d3d8b6bd5c63d8346079182204f30e" title="Writes the binary data to the open serial port. The data is copied to an internal buffer and written ..." alt="" coords="125,31,214,56"/>
<area shape="poly" title=" " alt="" coords="77,41,109,41,109,46,77,46"/>
<area shape="rect" href="serial_8c.html#a4ff646f526789549fa410a488a47abae" title="Writes the binary data to the &quot;real&quot; opened serial port handle within the virtual serial device struc..." alt="" coords="267,5,383,31"/>
<area shape="poly" title=" " alt="" coords="214,34,252,27,252,33,215,39"/>
<area shape="rect" href="serial_8c.html#a1375dc381934802544fa63f692f1d782" title="Writes the binary data to the virtual file handle within the virtual serial device structure." alt="" coords="262,55,388,80"/>
<area shape="poly" title=" " alt="" coords="215,48,247,53,246,58,214,53"/>
<area shape="rect" href="serial_8c.html#a706542c2b6ac4b13b60019221d8972ee" title="Prints an error message to stderr for the given error code, including the libserialport error message..." alt="" coords="436,5,551,31"/>
<area shape="poly" title=" " alt="" coords="384,16,421,16,421,21,384,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ab3d0be82de2dfcc8994230af517dbee9_icgraph.png" border="0" usemap="#aputil_8c_ab3d0be82de2dfcc8994230af517dbee9_icgraph" alt=""/></div>
<map name="aputil_8c_ab3d0be82de2dfcc8994230af517dbee9_icgraph" id="aputil_8c_ab3d0be82de2dfcc8994230af517dbee9_icgraph">
<area shape="rect" title="Waits for the given number of seconds by blocking the current thread. LOR heartbeat messages will int..." alt="" coords="244,5,315,31"/>
<area shape="rect" href="player_8c.html#aaf3b0aad85ffca607bbf0daa9d634dc1" title="Initializes and starts playback of the given playback configuration. Execution will block until the s..." alt="" coords="103,5,196,31"/>
<area shape="poly" title=" " alt="" coords="228,21,197,21,197,16,228,16"/>
<area shape="rect" href="main_8c.html#ad5a52bc0401ed1bc06c779de5371d560" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a4eb13572c6a1cf5854bb058e36e20562" name="a4eb13572c6a1cf5854bb058e36e20562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb13572c6a1cf5854bb058e36e20562">&#9670;&#160;</a></span>PU_writeEffect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PU_writeEffect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *</td>          <td class="paramname"><span class="paramname"><em>sdev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structctgroup__s.html">ctgroup_s</a> *</td>          <td class="paramname"><span class="paramname"><em>group</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>accum</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encodes the given channel group state update to the provided message buffer as a LOR effect. The number of bytes written to the message buffer will be added to the optional accumulator parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdev</td><td>serial device to write the effect to </td></tr>
    <tr><td class="paramname">group</td><td>channel group state to encode </td></tr>
    <tr><td class="paramname">accum</td><td>optional accumulator to store the number of bytes written </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, a negative error code on failure </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_a4eb13572c6a1cf5854bb058e36e20562_cgraph.png" border="0" usemap="#aputil_8c_a4eb13572c6a1cf5854bb058e36e20562_cgraph" alt=""/></div>
<map name="aputil_8c_a4eb13572c6a1cf5854bb058e36e20562_cgraph" id="aputil_8c_a4eb13572c6a1cf5854bb058e36e20562_cgraph">
<area shape="rect" title="Encodes the given channel group state update to the provided message buffer as a LOR effect...." alt="" coords="5,31,116,56"/>
<area shape="rect" href="serial_8c.html#a59d3d8b6bd5c63d8346079182204f30e" title="Writes the binary data to the open serial port. The data is copied to an internal buffer and written ..." alt="" coords="164,31,253,56"/>
<area shape="poly" title=" " alt="" coords="116,41,148,41,148,46,116,46"/>
<area shape="rect" href="serial_8c.html#a4ff646f526789549fa410a488a47abae" title="Writes the binary data to the &quot;real&quot; opened serial port handle within the virtual serial device struc..." alt="" coords="306,5,422,31"/>
<area shape="poly" title=" " alt="" coords="253,34,291,27,291,33,254,39"/>
<area shape="rect" href="serial_8c.html#a1375dc381934802544fa63f692f1d782" title="Writes the binary data to the virtual file handle within the virtual serial device structure." alt="" coords="301,55,427,80"/>
<area shape="poly" title=" " alt="" coords="254,48,286,53,285,58,253,53"/>
<area shape="rect" href="serial_8c.html#a706542c2b6ac4b13b60019221d8972ee" title="Prints an error message to stderr for the given error code, including the libserialport error message..." alt="" coords="475,5,590,31"/>
<area shape="poly" title=" " alt="" coords="423,16,460,16,460,21,423,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_a4eb13572c6a1cf5854bb058e36e20562_icgraph.png" border="0" usemap="#aputil_8c_a4eb13572c6a1cf5854bb058e36e20562_icgraph" alt=""/></div>
<map name="aputil_8c_a4eb13572c6a1cf5854bb058e36e20562_icgraph" id="aputil_8c_a4eb13572c6a1cf5854bb058e36e20562_icgraph">
<area shape="rect" title="Encodes the given channel group state update to the provided message buffer as a LOR effect...." alt="" coords="560,5,670,31"/>
<area shape="rect" href="player_8c.html#a0be44cb011fa97a198c60458b0761809" title="Increments the current frame index and writes the minified frame data to the serial output...." alt="" coords="381,5,512,31"/>
<area shape="poly" title=" " alt="" coords="544,21,512,21,512,16,544,16"/>
<area shape="rect" href="player_8c.html#a30eb7f640562f5e082f537431fabfae0" title="Main loop of the player that drives the playback of the sequence. This function will block until the ..." alt="" coords="244,5,333,31"/>
<area shape="poly" title=" " alt="" coords="365,21,334,21,334,16,365,16"/>
<area shape="rect" href="player_8c.html#aaf3b0aad85ffca607bbf0daa9d634dc1" title="Initializes and starts playback of the given playback configuration. Execution will block until the s..." alt="" coords="103,5,196,31"/>
<area shape="poly" title=" " alt="" coords="228,21,196,21,196,16,228,16"/>
<area shape="rect" href="main_8c.html#ad5a52bc0401ed1bc06c779de5371d560" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ad065eb627423f95e1ee6245f81c170d5" name="ad065eb627423f95e1ee6245f81c170d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad065eb627423f95e1ee6245f81c170d5">&#9670;&#160;</a></span>PU_writeHeartbeat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PU_writeHeartbeat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structserialdev__s.html">serialdev_s</a> *</td>          <td class="paramname"><span class="paramname"><em>sdev</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encodes and writes a LOR heartbeat message to the serial port. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdev</td><td>serial device to write the heartbeat message to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, a negative error code on failure </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ad065eb627423f95e1ee6245f81c170d5_cgraph.png" border="0" usemap="#aputil_8c_ad065eb627423f95e1ee6245f81c170d5_cgraph" alt=""/></div>
<map name="aputil_8c_ad065eb627423f95e1ee6245f81c170d5_cgraph" id="aputil_8c_ad065eb627423f95e1ee6245f81c170d5_cgraph">
<area shape="rect" title="Encodes and writes a LOR heartbeat message to the serial port." alt="" coords="5,31,138,56"/>
<area shape="rect" href="serial_8c.html#a59d3d8b6bd5c63d8346079182204f30e" title="Writes the binary data to the open serial port. The data is copied to an internal buffer and written ..." alt="" coords="186,31,275,56"/>
<area shape="poly" title=" " alt="" coords="138,41,170,41,170,46,138,46"/>
<area shape="rect" href="serial_8c.html#a4ff646f526789549fa410a488a47abae" title="Writes the binary data to the &quot;real&quot; opened serial port handle within the virtual serial device struc..." alt="" coords="328,5,444,31"/>
<area shape="poly" title=" " alt="" coords="275,34,313,27,313,33,276,39"/>
<area shape="rect" href="serial_8c.html#a1375dc381934802544fa63f692f1d782" title="Writes the binary data to the virtual file handle within the virtual serial device structure." alt="" coords="323,55,449,80"/>
<area shape="poly" title=" " alt="" coords="276,48,308,53,307,58,275,53"/>
<area shape="rect" href="serial_8c.html#a706542c2b6ac4b13b60019221d8972ee" title="Prints an error message to stderr for the given error code, including the libserialport error message..." alt="" coords="497,5,612,31"/>
<area shape="poly" title=" " alt="" coords="445,16,482,16,482,21,445,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="putil_8c_ad065eb627423f95e1ee6245f81c170d5_icgraph.png" border="0" usemap="#aputil_8c_ad065eb627423f95e1ee6245f81c170d5_icgraph" alt=""/></div>
<map name="aputil_8c_ad065eb627423f95e1ee6245f81c170d5_icgraph" id="aputil_8c_ad065eb627423f95e1ee6245f81c170d5_icgraph">
<area shape="rect" title="Encodes and writes a LOR heartbeat message to the serial port." alt="" coords="381,5,514,31"/>
<area shape="rect" href="player_8c.html#a30eb7f640562f5e082f537431fabfae0" title="Main loop of the player that drives the playback of the sequence. This function will block until the ..." alt="" coords="244,5,333,31"/>
<area shape="poly" title=" " alt="" coords="366,21,334,21,334,16,366,16"/>
<area shape="rect" href="player_8c.html#aaf3b0aad85ffca607bbf0daa9d634dc1" title="Initializes and starts playback of the given playback configuration. Execution will block until the s..." alt="" coords="103,5,196,31"/>
<area shape="poly" title=" " alt="" coords="228,21,196,21,196,16,228,16"/>
<area shape="rect" href="main_8c.html#ad5a52bc0401ed1bc06c779de5371d560" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="putil_8c.html">putil.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
